<!doctype html>
<html lang="en" class="min-h-screen bg-gray-900 bg-fixed">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>Contrast Color</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://unpkg.com/tailwindcss@^2.0/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="min-h-screen text-contrast bg-gradient-to-b from-gray-700 to-gray-900 bg-fixed">

  <div class="page py-8 px-4">
    <header></header>
    <main class="py-8">
      <section class="mx-auto max-w-prose space-y-4">
        <h1 class="text-gray-400 text-3xl font-thin flex items-center">
          Contrast Color
          <a href="https://gist.github.com/craigerskine/ea2f7e38a62aeb0ec4e7f0ac8b09b5b3" class="ml-auto text-xs text-blue-300">View Code</a>
        </h1>
        <p>I'm looking to use this type of color contrast logic within TailwindCSS. Ideally it would be a <code>.text-contrast</code> class that 'enables' a CSS var that is auto applied to every <code>.bg-<i>color</i></code></p>
        <pre class="p-3 bg-black bg-opacity-50 text-gray-400 text-xs rounded shadow-lg overflow-x-scroll">.bg-black {
  --tw-bg-opacity: 1;
  --tw-fg-contrast: #FFF;
  background-color: rgba(0,0,0,var(--tw-bg-opacity));
}
.text-contrast {
  color: var(--tw-fg-contrast);
}</pre>
        <p>So, you would have the option to use an auto contrast for accessibility. If anyone can help build a TailwindCSS plugin to do this, I would be most grateful.</p>
        <p>Here's the partial jQuery plugin I Frankenstein'd together that I've been using:</p>
        <pre class="p-3 bg-black bg-opacity-50 text-gray-400 text-xs rounded shadow-lg overflow-x-scroll">$.fn.contrastColor = function(target){
  return this.each(function(){
    var target = target;
    if(target === undefined){ target = this; }
    var bg = $(this).css('background-color');
    // use first opaque parent bg if element is transparent
    if(bg == 'transparent' || bg == 'rgba(0, 0, 0, 0)'){ 
      $(this).parents().each(function(){
        bg = $(this).css('background-color')
        if(bg != 'transparent' && bg != 'rgba(0, 0, 0, 0)') return false; 
      });
      // exit if all parents are transparent
      if(bg == 'transparent' || bg == 'rgba(0, 0, 0, 0)') return false;
    }
    // get r,g,b and decide
    var rgb = bg.replace(/^(rgb|rgba)\(/,'').replace(/\)$/,'').replace(/\s/g,'').split(',');
    var yiq = ((rgb[0]*299)+(rgb[1]*587)+(rgb[2]*114))/1000;
    // if light
    if(yiq >= 128) $(target).addClass('text-gray-800');
    // if dark
    else $(target).addClass('text-white');
  });
};
$(function(){
  $('.text-contrast').contrastColor();
});</pre>
        <hr class="border-gray-500 border-opacity-25" />
        <h2 class="text-gray-400 text-2xl font-thin">Demo of the jQuery Plugin</h2>
        <ul class="flex justify-center space-x-4">
          <li class="p-1 md:p-4 bg-black rounded text-contrast">Black</li>
          <li class="p-1 md:p-4 bg-white rounded text-contrast">White</li>
          <li class="p-1 md:p-4 bg-transparent rounded text-contrast">Transparent</li>
          <li class="p-1 md:p-4 bg-gray-200 rounded"><div><div><div class="text-contrast">Nested</div></div></div></li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-gray-100 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-200 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-300 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-400 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-500 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-600 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-700 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-800 rounded text-contrast">Gy</li>
          <li class="p-1 md:p-4 bg-gray-900 rounded text-contrast">Gy</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-red-100 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-200 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-300 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-400 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-500 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-600 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-700 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-800 rounded text-contrast">Re</li>
          <li class="p-1 md:p-4 bg-red-900 rounded text-contrast">Re</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-yellow-100 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-200 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-300 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-400 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-500 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-600 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-700 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-800 rounded text-contrast">Ye</li>
          <li class="p-1 md:p-4 bg-yellow-900 rounded text-contrast">Ye</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-green-100 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-200 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-300 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-400 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-500 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-600 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-700 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-800 rounded text-contrast">Gr</li>
          <li class="p-1 md:p-4 bg-green-900 rounded text-contrast">Gr</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-blue-100 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-200 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-300 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-400 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-500 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-600 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-700 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-800 rounded text-contrast">Bl</li>
          <li class="p-1 md:p-4 bg-blue-900 rounded text-contrast">Bl</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-indigo-100 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-200 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-300 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-400 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-500 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-600 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-700 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-800 rounded text-contrast">In</li>
          <li class="p-1 md:p-4 bg-indigo-900 rounded text-contrast">In</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-purple-100 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-200 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-300 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-400 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-500 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-600 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-700 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-800 rounded text-contrast">Pu</li>
          <li class="p-1 md:p-4 bg-purple-900 rounded text-contrast">Pu</li>
        </ul>
        <ul class="flex justify-center space-x-4 font-mono">
          <li class="p-1 md:p-4 bg-pink-100 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-200 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-300 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-400 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-500 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-600 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-700 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-800 rounded text-contrast">Pi</li>
          <li class="p-1 md:p-4 bg-pink-900 rounded text-contrast">Pi</li>
        </ul>
      </section>
    </main>
    <footer class="pt-8 border-t border-gray-500 border-opacity-25 text-xs font-bold uppercase text-right opacity-50">
      Made with <svg xmlns="http://www.w3.org/2000/svg" class="mx-1 text-red-400 align-top inline-block" width="16" height="16" viewBox="0 0 16 16" role="img" aria-labelledby="foot-love"><title id="foot-love">Love</title><polygon class="fill-current" fill-rule="evenodd" points="8 6 11 3 15 7 8 14 1 7 5 3"></polygon></svg> by <a href="http://craigerskine.com/" class="mx-1">Craig Erskine (qrayg)</a>
    </footer>
  </div>

  <script src="https://unpkg.com/jquery/dist/jquery.min.js"></script>
  <script>
    // jQuery contrastColor
    // Usage: $('.element').contrastColor('.optional-target-element');
    $.fn.contrastColor = function(target){
      return this.each(function(){
        var target = target;
        if(target === undefined){ target = this; }
        var bg = $(this).css('background-color');
        // use first opaque parent bg if element is transparent
        if(bg == 'transparent' || bg == 'rgba(0, 0, 0, 0)'){ 
          $(this).parents().each(function(){
            bg = $(this).css('background-color')
            if(bg != 'transparent' && bg != 'rgba(0, 0, 0, 0)') return false; 
          });
          // exit if all parents are transparent
          if(bg == 'transparent' || bg == 'rgba(0, 0, 0, 0)') return false;
        }
        // get r,g,b and decide
        var rgb = bg.replace(/^(rgb|rgba)\(/,'').replace(/\)$/,'').replace(/\s/g,'').split(',');
        var yiq = ((rgb[0]*299)+(rgb[1]*587)+(rgb[2]*114))/1000;
        // if light
        if(yiq >= 128) $(target).addClass('text-gray-800');
        // if dark
        else $(target).addClass('text-white');
      });
    };
    $(function(){
      $('.text-contrast').contrastColor();
    });
  </script>

</body>
</html>